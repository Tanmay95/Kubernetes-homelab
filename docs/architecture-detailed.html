<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homelab Architecture - Complete Traffic Flow</title>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-orange: #d29922;
            --accent-red: #f85149;
            --accent-purple: #a371f7;
            --accent-cyan: #39c5cf;
            --accent-pink: #db61a2;
            --border-color: #30363d;
            --code-bg: #1a1f26;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            border-bottom: 1px solid var(--border-color);
            padding: 3rem 0;
            margin-bottom: 2rem;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.2rem;
        }

        section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        h2 {
            color: var(--accent-blue);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        h3 {
            color: var(--accent-green);
            margin: 1.5rem 0 1rem;
            font-size: 1.3rem;
        }

        h4 {
            color: var(--accent-orange);
            margin: 1rem 0 0.5rem;
            font-size: 1.1rem;
        }

        p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .architecture-diagram {
            background: linear-gradient(180deg, #0d1117 0%, #161b22 100%);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
            font-size: 0.7rem;
            line-height: 1.3;
            overflow-x: auto;
            white-space: pre;
            color: var(--text-primary);
            margin: 1.5rem 0;
        }

        .flow-section {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--accent-purple);
        }

        .step-box {
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            position: relative;
        }

        .step-number {
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--accent-purple);
            color: var(--bg-primary);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            margin: 0.2rem;
        }

        .badge-blue { background: var(--accent-blue); color: var(--bg-primary); }
        .badge-green { background: var(--accent-green); color: var(--bg-primary); }
        .badge-orange { background: var(--accent-orange); color: var(--bg-primary); }
        .badge-purple { background: var(--accent-purple); color: var(--bg-primary); }
        .badge-red { background: var(--accent-red); color: var(--bg-primary); }
        .badge-cyan { background: var(--accent-cyan); color: var(--bg-primary); }
        .badge-pink { background: var(--accent-pink); color: var(--bg-primary); }

        .highlight-box {
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .highlight-blue {
            background: rgba(88, 166, 255, 0.1);
            border-left: 4px solid var(--accent-blue);
        }

        .highlight-green {
            background: rgba(63, 185, 80, 0.1);
            border-left: 4px solid var(--accent-green);
        }

        .highlight-orange {
            background: rgba(210, 153, 34, 0.1);
            border-left: 4px solid var(--accent-orange);
        }

        .highlight-red {
            background: rgba(248, 81, 73, 0.1);
            border-left: 4px solid var(--accent-red);
        }

        .highlight-cyan {
            background: rgba(57, 197, 207, 0.1);
            border-left: 4px solid var(--accent-cyan);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--bg-tertiary);
            color: var(--accent-blue);
        }

        td {
            color: var(--text-secondary);
        }

        code {
            background: var(--code-bg);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.85em;
            color: var(--accent-orange);
        }

        pre {
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--text-primary);
        }

        .arrow {
            color: var(--accent-green);
            font-size: 1.5rem;
            text-align: center;
            margin: 0.5rem 0;
        }

        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .component-card {
            background: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
        }

        .component-card h4 {
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .icon {
            font-size: 1.5rem;
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
            border-top: 1px solid var(--border-color);
            margin-top: 2rem;
        }

        .tls-flow {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .tls-step {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem;
            border-radius: 4px;
        }

        .tls-step.encrypted {
            background: rgba(63, 185, 80, 0.1);
            border: 1px solid var(--accent-green);
        }

        .tls-step.plain {
            background: rgba(210, 153, 34, 0.1);
            border: 1px solid var(--accent-orange);
        }

        .lock-icon {
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            header h1 {
                font-size: 1.5rem;
            }
            
            .architecture-diagram {
                font-size: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>ğŸ—ï¸ Homelab Architecture - Complete Traffic Flow</h1>
            <p>Detailed walkthrough: Browser â†’ ArgoCD with TLS certificates explained</p>
        </div>
    </header>

    <div class="container">
        <!-- Infrastructure Overview -->
        <section>
            <h2>ğŸ“ Infrastructure Overview</h2>
            <p>Your homelab runs Kubernetes on Talos Linux, managed via Proxmox VMs, with GitOps deployment through ArgoCD.</p>

            <div class="architecture-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                           YOUR HOME NETWORK (192.168.1.0/24)                                        â”‚
â”‚                                                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                  â”‚
â”‚   â”‚   Router     â”‚                                                                                                  â”‚
â”‚   â”‚ 192.168.1.1  â”‚                                                                                                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                  â”‚
â”‚          â”‚                                                                                                          â”‚
â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚          â”‚  â”‚                              PROXMOX HYPERVISOR                                                     â”‚ â”‚
â”‚          â”‚  â”‚                                                                                                     â”‚ â”‚
â”‚          â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚                         KUBERNETES CLUSTER (Talos Linux)                                    â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚                                                                                             â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚  talos-control-01  â”‚   â”‚  talos-worker-01   â”‚   â”‚  talos-worker-02   â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚   192.168.1.112    â”‚   â”‚   192.168.1.113    â”‚   â”‚   192.168.1.114    â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚                    â”‚   â”‚                    â”‚   â”‚                    â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚  â”‚ kube-apiserverâ”‚  â”‚   â”‚  â”‚   Cilium    â”‚  â”‚   â”‚  â”‚   Cilium    â”‚  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚  â”‚ etcd         â”‚  â”‚   â”‚  â”‚   Agent     â”‚  â”‚   â”‚  â”‚   Agent     â”‚  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚  â”‚ Cilium Agent â”‚  â”‚   â”‚  â”‚             â”‚  â”‚   â”‚  â”‚             â”‚  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚                    â”‚   â”‚  â”‚ â”‚ ArgoCD  â”‚ â”‚  â”‚   â”‚  â”‚ â”‚  Pods   â”‚ â”‚  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚                    â”‚   â”‚  â”‚ â”‚  Pod    â”‚ â”‚  â”‚   â”‚  â”‚ â”‚         â”‚ â”‚  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â”‚                    â”‚   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚                                                                                             â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘                        CILIUM L2 ANNOUNCEMENTS                                     â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘                                                                                    â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘     IP Pool: 192.168.1.100 - 192.168.1.115                                        â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘                                                                                    â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘     â”‚  Gateway-Internal   â”‚        â”‚  Gateway-External   â”‚                        â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘     â”‚   192.168.1.101     â”‚        â”‚   192.168.1.102     â”‚                        â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘     â”‚   (LoadBalancer)    â”‚        â”‚   (LoadBalancer)    â”‚                        â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•‘     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â•‘   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â”‚                                                                                             â”‚   â”‚ â”‚
â”‚          â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                                                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                                                                                  â”‚
â”‚   â”‚  Your PC     â”‚                                                                                                  â”‚
â”‚   â”‚ 192.168.1.x  â”‚  â—„â”€â”€â”€â”€â”€ You browse from here                                                                    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                                  â”‚
â”‚                                                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>

            <h3>Component Summary</h3>
            <div class="component-grid">
                <div class="component-card">
                    <h4><span class="icon">ğŸ–¥ï¸</span> Proxmox</h4>
                    <p>Hypervisor hosting the Kubernetes VMs. Manages resource allocation.</p>
                </div>
                <div class="component-card">
                    <h4><span class="icon">ğŸ§</span> Talos Linux</h4>
                    <p>Immutable, API-driven Kubernetes OS. No SSH, managed via <code>talosctl</code>.</p>
                </div>
                <div class="component-card">
                    <h4><span class="icon">ğŸ</span> Cilium</h4>
                    <p>CNI providing networking, Gateway API, L2 announcements, and load balancing.</p>
                </div>
                <div class="component-card">
                    <h4><span class="icon">ğŸš€</span> ArgoCD</h4>
                    <p>GitOps controller syncing Kubernetes resources from Git repository.</p>
                </div>
                <div class="component-card">
                    <h4><span class="icon">ğŸ”</span> cert-manager</h4>
                    <p>Automates TLS certificate provisioning and renewal.</p>
                </div>
                <div class="component-card">
                    <h4><span class="icon">ğŸšª</span> Gateway API</h4>
                    <p>Modern Kubernetes API for traffic routing (replaces Ingress).</p>
                </div>
            </div>
        </section>

        <!-- Complete ArgoCD Request Flow -->
        <section>
            <h2>ğŸ”„ Complete Request Flow: Browser â†’ ArgoCD</h2>
            <p>Let's trace exactly what happens when you type <code>https://argocd.starbasestudio.uk</code> in your browser.</p>

            <div class="architecture-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                                              â”‚
â”‚  STEP 1: DNS RESOLUTION                                                                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                                    â”‚
â”‚                                                                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                           â”‚
â”‚   â”‚   Browser   â”‚  â”€â”€â”€â”€â–º  â”‚   /etc/hosts or     â”‚  â”€â”€â”€â”€â–º  argocd.starbasestudio.uk = 192.168.1.102                         â”‚
â”‚   â”‚             â”‚   DNS   â”‚   DNS Server        â”‚                                                                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                           â”‚
â”‚                                                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                                              â”‚
â”‚  STEP 2: TCP CONNECTION                                                                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                                     â”‚
â”‚                                                                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚   â”‚   Browser   â”‚  â•â•â•â•â•â•â•â• TCP SYN â•â•â•â•â•â•â•â–º  â”‚         192.168.1.102:443              â”‚                                   â”‚
â”‚   â”‚             â”‚  â—„â•â•â•â•â•â•â• TCP SYN-ACK â•â•â•â•  â”‚      (Gateway-External Service)        â”‚                                   â”‚
â”‚   â”‚             â”‚  â•â•â•â•â•â•â•â• TCP ACK â•â•â•â•â•â•â•â–º  â”‚                                        â”‚                                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                                                                                              â”‚
â”‚   Cilium L2 Announcement: "192.168.1.102 is at MAC aa:bb:cc:dd:ee:ff" (worker node MAC)                                    â”‚
â”‚                                                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                                              â”‚
â”‚  STEP 3: TLS HANDSHAKE (Client Hello â†’ Server Hello â†’ Certificate)                                                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                          â”‚
â”‚                                                                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚   â”‚   Browser   â”‚  â”€â”€â”€ ClientHello â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚         Gateway (Cilium)               â”‚                                   â”‚
â”‚   â”‚             â”‚      (TLS 1.3, SNI:argocd..)â”‚                                        â”‚                                   â”‚
â”‚   â”‚             â”‚                              â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                                   â”‚
â”‚   â”‚             â”‚  â—„â”€â”€ ServerHello â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚   argocd-tls-secret            â”‚   â”‚                                   â”‚
â”‚   â”‚             â”‚      + Certificate          â”‚   â”‚   (from cert-manager)          â”‚   â”‚                                   â”‚
â”‚   â”‚             â”‚                              â”‚   â”‚                                â”‚   â”‚                                   â”‚
â”‚   â”‚             â”‚                              â”‚   â”‚   CN: argocd.starbasestudio.ukâ”‚   â”‚                                   â”‚
â”‚   â”‚             â”‚                              â”‚   â”‚   Issuer: selfsigned-issuer   â”‚   â”‚                                   â”‚
â”‚   â”‚             â”‚                              â”‚   â”‚   Valid: 90 days              â”‚   â”‚                                   â”‚
â”‚   â”‚             â”‚                              â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                                   â”‚
â”‚   â”‚             â”‚  â”€â”€â”€ Key Exchange â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚                                        â”‚                                   â”‚
â”‚   â”‚             â”‚  â—„â”€â”€ Finished â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                                        â”‚                                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                                                                                              â”‚
â”‚   âš ï¸  Browser Warning: "Your connection is not private" (self-signed certificate)                                          â”‚
â”‚       Click "Advanced" â†’ "Proceed to argocd.starbasestudio.uk"                                                              â”‚
â”‚                                                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                                              â”‚
â”‚  STEP 4: ENCRYPTED HTTPS REQUEST                                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                         â”‚
â”‚                                                                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           ğŸ”’ ENCRYPTED                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚   â”‚   Browser   â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º   â”‚         Gateway (Cilium)               â”‚                          â”‚
â”‚   â”‚             â”‚                                       â”‚                                        â”‚                          â”‚
â”‚   â”‚             â”‚   GET / HTTP/1.1                      â”‚   Listener: https (port 443)          â”‚                          â”‚
â”‚   â”‚             â”‚   Host: argocd.starbasestudio.uk      â”‚   hostname: argocd.starbasestudio.uk  â”‚                          â”‚
â”‚   â”‚             â”‚   (encrypted with session key)        â”‚   TLS Mode: Terminate                 â”‚                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚                                        â”‚                          â”‚
â”‚                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                                              â”‚
â”‚  STEP 5: TLS TERMINATION & DECRYPTION                                                                                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                       â”‚
â”‚                                                                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚                                    GATEWAY (Inside Cilium)                                             â”‚                â”‚
â”‚   â”‚                                                                                                        â”‚                â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚                â”‚
â”‚   â”‚   â”‚  TLS Listener   â”‚  â”€â”€â”€â”€â–º  â”‚   Decryption    â”‚  â”€â”€â”€â”€â–º  â”‚  Plain HTTP     â”‚                         â”‚                â”‚
â”‚   â”‚   â”‚  (port 443)     â”‚         â”‚   Engine        â”‚         â”‚  Request        â”‚                         â”‚                â”‚
â”‚   â”‚   â”‚                 â”‚         â”‚                 â”‚         â”‚                 â”‚                         â”‚                â”‚
â”‚   â”‚   â”‚  Uses:          â”‚         â”‚  ğŸ”“ Decrypts   â”‚         â”‚  GET / HTTP/1.1 â”‚                         â”‚                â”‚
â”‚   â”‚   â”‚  argocd-tls-    â”‚         â”‚  using private  â”‚         â”‚  Host: argocd.. â”‚                         â”‚                â”‚
â”‚   â”‚   â”‚  secret         â”‚         â”‚  key from       â”‚         â”‚                 â”‚                         â”‚                â”‚
â”‚   â”‚   â”‚                 â”‚         â”‚  secret         â”‚         â”‚                 â”‚                         â”‚                â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚                â”‚
â”‚   â”‚                                                                                                        â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                                              â”‚
â”‚  STEP 6: HTTPROUTE MATCHING                                                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                                 â”‚
â”‚                                                                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚                                    HTTPRoute: argocd-http                                              â”‚                â”‚
â”‚   â”‚                                                                                                        â”‚                â”‚
â”‚   â”‚   parentRefs:                                                                                          â”‚                â”‚
â”‚   â”‚     - gateway-external (sectionName: https)  â—„â”€â”€â”€ Matches this gateway!                               â”‚                â”‚
â”‚   â”‚     - gateway-internal (sectionName: https)                                                            â”‚                â”‚
â”‚   â”‚                                                                                                        â”‚                â”‚
â”‚   â”‚   hostnames:                                                                                           â”‚                â”‚
â”‚   â”‚     - argocd.starbasestudio.uk  â—„â”€â”€â”€ Matches request hostname!                                        â”‚                â”‚
â”‚   â”‚                                                                                                        â”‚                â”‚
â”‚   â”‚   rules:                                                                                               â”‚                â”‚
â”‚   â”‚     - backendRefs:                                                                                     â”‚                â”‚
â”‚   â”‚         - name: argocd-server                                                                          â”‚                â”‚
â”‚   â”‚           port: 80  â—„â”€â”€â”€ Route to this service on HTTP port                                           â”‚                â”‚
â”‚   â”‚                                                                                                        â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                                              â”‚
â”‚  STEP 7: INTERNAL ROUTING (Plain HTTP)                                                                                       â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                      â”‚
â”‚                                                                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚    Gateway      â”‚  â”€â”€â”€â”€â–º  â”‚  Service: argocd-server     â”‚  â”€â”€â”€â”€â–º  â”‚  ArgoCD Pod                     â”‚                  â”‚
â”‚   â”‚   (Cilium)      â”‚   ğŸ”“    â”‚  Namespace: argocd          â”‚   ğŸ”“    â”‚  Container Port: 8080           â”‚                  â”‚
â”‚   â”‚                 â”‚  HTTP   â”‚  Port: 80 â†’ targetPort: 8080â”‚  HTTP   â”‚                                 â”‚                  â”‚
â”‚   â”‚  192.168.1.102  â”‚         â”‚  ClusterIP: 10.x.x.x        â”‚         â”‚  Pod IP: 10.y.y.y               â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                                                                              â”‚
â”‚   Traffic is PLAIN HTTP inside the cluster (no encryption)                                                                  â”‚
â”‚   This is secure because it never leaves the cluster network                                                                â”‚
â”‚                                                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                                                              â”‚
â”‚  STEP 8: RESPONSE FLOW (Reverse Path)                                                                                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                                       â”‚
â”‚                                                                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚  ArgoCD Pod                     â”‚  â”€â”€â”€â”€â–º  â”‚  Gateway (Cilium)           â”‚  â•â•â•â•â–º  â”‚   Browser       â”‚                  â”‚
â”‚   â”‚                                 â”‚   ğŸ”“    â”‚                             â”‚   ğŸ”’    â”‚                 â”‚                  â”‚
â”‚   â”‚  HTTP 200 OK                    â”‚  HTTP   â”‚  Re-encrypts response       â”‚  HTTPS  â”‚  Renders page   â”‚                  â”‚
â”‚   â”‚  Content-Type: text/html        â”‚         â”‚  with session key           â”‚         â”‚                 â”‚                  â”‚
â”‚   â”‚  <html>ArgoCD UI...</html>      â”‚         â”‚                             â”‚         â”‚                 â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>
        </section>

        <!-- TLS Certificate Flow -->
        <section>
            <h2>ğŸ” TLS Certificate Lifecycle</h2>
            <p>How cert-manager provisions and manages the TLS certificate for ArgoCD.</p>

            <div class="architecture-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                                             â”‚
â”‚                                   CERTIFICATE PROVISIONING FLOW                                                             â”‚
â”‚                                                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. GATEWAY CREATION                                                                                                â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  You apply Gateway YAML with annotation:                                                                            â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  metadata:                                                                                                          â”‚   â”‚
â”‚  â”‚    annotations:                                                                                                     â”‚   â”‚
â”‚  â”‚      cert-manager.io/cluster-issuer: selfsigned-issuer  â—„â”€â”€â”€ Tells cert-manager which issuer to use                â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  spec:                                                                                                              â”‚   â”‚
â”‚  â”‚    listeners:                                                                                                       â”‚   â”‚
â”‚  â”‚      - name: https                                                                                                  â”‚   â”‚
â”‚  â”‚        hostname: argocd.starbasestudio.uk                                                                           â”‚   â”‚
â”‚  â”‚        tls:                                                                                                         â”‚   â”‚
â”‚  â”‚          certificateRefs:                                                                                           â”‚   â”‚
â”‚  â”‚            - name: argocd-tls-secret  â—„â”€â”€â”€ Secret name for the certificate                                         â”‚   â”‚
â”‚  â”‚              kind: Secret                                                                                           â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. CERT-MANAGER DETECTS GATEWAY                                                                                    â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  cert-manager's gateway-shim controller watches for Gateways with its annotation:                                  â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                          â”‚   â”‚
â”‚  â”‚  â”‚  cert-manager Pod     â”‚                                                                                          â”‚   â”‚
â”‚  â”‚  â”‚                       â”‚     "I see a Gateway needs a certificate!"                                               â”‚   â”‚
â”‚  â”‚  â”‚  - controller         â”‚     "Annotation: selfsigned-issuer"                                                      â”‚   â”‚
â”‚  â”‚  â”‚  - webhook            â”‚     "Secret needed: argocd-tls-secret"                                                   â”‚   â”‚
â”‚  â”‚  â”‚  - cainjector         â”‚     "Hostname: argocd.starbasestudio.uk"                                                 â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                          â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. CERT-MANAGER CREATES CERTIFICATE RESOURCE                                                                       â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  apiVersion: cert-manager.io/v1                                                                                     â”‚   â”‚
â”‚  â”‚  kind: Certificate                                                                                                  â”‚   â”‚
â”‚  â”‚  metadata:                                                                                                          â”‚   â”‚
â”‚  â”‚    name: argocd-tls-secret          â—„â”€â”€â”€ Auto-generated name matches secret                                        â”‚   â”‚
â”‚  â”‚    namespace: gateway                                                                                               â”‚   â”‚
â”‚  â”‚  spec:                                                                                                              â”‚   â”‚
â”‚  â”‚    secretName: argocd-tls-secret                                                                                    â”‚   â”‚
â”‚  â”‚    dnsNames:                                                                                                        â”‚   â”‚
â”‚  â”‚      - argocd.starbasestudio.uk     â—„â”€â”€â”€ From Gateway listener hostname                                            â”‚   â”‚
â”‚  â”‚    issuerRef:                                                                                                       â”‚   â”‚
â”‚  â”‚      name: selfsigned-issuer        â—„â”€â”€â”€ From Gateway annotation                                                   â”‚   â”‚
â”‚  â”‚      kind: ClusterIssuer                                                                                            â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. CLUSTERISSUER GENERATES CERTIFICATE                                                                             â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  ClusterIssuer: selfsigned-issuer                                                                           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  spec:                                                                                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    selfSigned: {}   â—„â”€â”€â”€ Generate certificate signed by itself (no external CA)                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Actions:                                                                                                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    1. Generate RSA 2048-bit private key                                                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    2. Create X.509 certificate with:                                                                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚       - Subject: CN=argocd.starbasestudio.uk                                                                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚       - SAN (Subject Alternative Name): DNS:argocd.starbasestudio.uk                                        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚       - Validity: 90 days (default)                                                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚       - Issuer: CN=argocd.starbasestudio.uk (self-signed, so same as subject)                               â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    3. Sign certificate with the private key                                                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                                                             â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. SECRET CREATED                                                                                                  â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  apiVersion: v1                                                                                                     â”‚   â”‚
â”‚  â”‚  kind: Secret                                                                                                       â”‚   â”‚
â”‚  â”‚  metadata:                                                                                                          â”‚   â”‚
â”‚  â”‚    name: argocd-tls-secret                                                                                          â”‚   â”‚
â”‚  â”‚    namespace: gateway                                                                                               â”‚   â”‚
â”‚  â”‚  type: kubernetes.io/tls                                                                                            â”‚   â”‚
â”‚  â”‚  data:                                                                                                              â”‚   â”‚
â”‚  â”‚    tls.crt: LS0tLS1CRUdJTi... â—„â”€â”€â”€ Base64 encoded certificate (public)                                            â”‚   â”‚
â”‚  â”‚    tls.key: LS0tLS1CRUdJTi... â—„â”€â”€â”€ Base64 encoded private key (secret!)                                           â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  The certificate contains:                                                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚   â”‚
â”‚  â”‚  â”‚  Certificate:                                                                    â”‚                               â”‚   â”‚
â”‚  â”‚  â”‚    Subject: CN = argocd.starbasestudio.uk                                        â”‚                               â”‚   â”‚
â”‚  â”‚  â”‚    Issuer: CN = argocd.starbasestudio.uk (self-signed)                           â”‚                               â”‚   â”‚
â”‚  â”‚  â”‚    Validity:                                                                     â”‚                               â”‚   â”‚
â”‚  â”‚  â”‚      Not Before: Jan 19 21:00:00 2026 GMT                                        â”‚                               â”‚   â”‚
â”‚  â”‚  â”‚      Not After : Apr 19 21:00:00 2026 GMT                                        â”‚                               â”‚   â”‚
â”‚  â”‚  â”‚    Subject Alternative Name:                                                     â”‚                               â”‚   â”‚
â”‚  â”‚  â”‚      DNS: argocd.starbasestudio.uk                                               â”‚                               â”‚   â”‚
â”‚  â”‚  â”‚    Public Key Algorithm: RSA (2048 bit)                                          â”‚                               â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  6. GATEWAY USES SECRET FOR TLS                                                                                     â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  Cilium Gateway controller:                                                                                         â”‚   â”‚
â”‚  â”‚    1. Watches for Gateway resources                                                                                 â”‚   â”‚
â”‚  â”‚    2. Reads argocd-tls-secret from gateway namespace                                                                â”‚   â”‚
â”‚  â”‚    3. Loads certificate + private key into memory                                                                   â”‚   â”‚
â”‚  â”‚    4. Configures TLS termination on the HTTPS listener                                                              â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  Now the Gateway can:                                                                                               â”‚   â”‚
â”‚  â”‚    - Present the certificate during TLS handshake                                                                   â”‚   â”‚
â”‚  â”‚    - Decrypt incoming HTTPS traffic using the private key                                                           â”‚   â”‚
â”‚  â”‚    - Encrypt outgoing HTTPS responses                                                                               â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>

            <h3>Why Browser Shows Warning</h3>
            <div class="highlight-orange">
                <h4>âš ï¸ "Your connection is not private"</h4>
                <p>This happens because the certificate is <strong>self-signed</strong>:</p>
                <ul style="color: var(--text-secondary); margin-left: 1rem;">
                    <li>Browsers only trust certificates signed by known Certificate Authorities (CAs)</li>
                    <li>Self-signed means the certificate vouches for itself</li>
                    <li>No trusted third party (like Let's Encrypt) verified it</li>
                    <li>This is fine for homelab/internal use - you know it's your certificate</li>
                </ul>
            </div>

            <h3>Certificate Renewal</h3>
            <div class="highlight-green">
                <h4>ğŸ”„ Automatic Renewal</h4>
                <p>cert-manager automatically renews certificates before expiry:</p>
                <ul style="color: var(--text-secondary); margin-left: 1rem;">
                    <li>Default renewal: 30 days before expiry</li>
                    <li>No manual intervention needed</li>
                    <li>New secret is created, Gateway reloads it</li>
                </ul>
            </div>
        </section>

        <!-- Data Flow Summary -->
        <section>
            <h2>ğŸ“Š Traffic Encryption Summary</h2>
            
            <table>
                <tr>
                    <th>Segment</th>
                    <th>From</th>
                    <th>To</th>
                    <th>Encryption</th>
                    <th>Protocol</th>
                </tr>
                <tr>
                    <td><span class="badge badge-green">1</span></td>
                    <td>Browser</td>
                    <td>Gateway (192.168.1.102:443)</td>
                    <td>ğŸ”’ TLS 1.3 Encrypted</td>
                    <td>HTTPS</td>
                </tr>
                <tr>
                    <td><span class="badge badge-orange">2</span></td>
                    <td>Gateway</td>
                    <td>argocd-server Service</td>
                    <td>ğŸ”“ Plain text</td>
                    <td>HTTP</td>
                </tr>
                <tr>
                    <td><span class="badge badge-orange">3</span></td>
                    <td>Service</td>
                    <td>ArgoCD Pod</td>
                    <td>ğŸ”“ Plain text</td>
                    <td>HTTP</td>
                </tr>
                <tr>
                    <td><span class="badge badge-orange">4</span></td>
                    <td>ArgoCD Pod</td>
                    <td>Gateway</td>
                    <td>ğŸ”“ Plain text</td>
                    <td>HTTP</td>
                </tr>
                <tr>
                    <td><span class="badge badge-green">5</span></td>
                    <td>Gateway</td>
                    <td>Browser</td>
                    <td>ğŸ”’ TLS 1.3 Encrypted</td>
                    <td>HTTPS</td>
                </tr>
            </table>

            <div class="highlight-blue">
                <h4>ğŸ“ Why is internal traffic unencrypted?</h4>
                <p>Traffic inside the Kubernetes cluster stays within the cluster network, which is:</p>
                <ul style="color: var(--text-secondary); margin-left: 1rem;">
                    <li>Isolated from external networks</li>
                    <li>Only accessible by pods in the cluster</li>
                    <li>Protected by Kubernetes network policies</li>
                    <li>Encrypting would add latency with minimal security benefit</li>
                </ul>
                <p>For high-security environments, you can enable mTLS with service mesh (Istio/Linkerd) or Cilium's encryption features.</p>
            </div>
        </section>

        <!-- Cilium L2 Announcements -->
        <section>
            <h2>ğŸ“¡ Cilium L2 Announcements Deep Dive</h2>
            <p>How Cilium makes the Gateway IP reachable on your home network.</p>

            <div class="architecture-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                                             â”‚
â”‚                                   HOW L2 ANNOUNCEMENTS WORK                                                                 â”‚
â”‚                                                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. SERVICE CREATION                                                                                                â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  When Gateway is created, Cilium creates a LoadBalancer Service:                                                    â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  Service: cilium-gateway-gateway-external                                                                           â”‚   â”‚
â”‚  â”‚    type: LoadBalancer                                                                                               â”‚   â”‚
â”‚  â”‚    spec.loadBalancerIP: 192.168.1.102  â—„â”€â”€â”€ Requested IP from Gateway                                              â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. IP POOL ALLOCATION                                                                                              â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  CiliumLoadBalancerIPPool: main-pool                                                                                â”‚   â”‚
â”‚  â”‚    blocks:                                                                                                          â”‚   â”‚
â”‚  â”‚      - start: 192.168.1.100                                                                                         â”‚   â”‚
â”‚  â”‚        stop: 192.168.1.115                                                                                          â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  Cilium checks:                                                                                                     â”‚   â”‚
â”‚  â”‚    âœ“ 192.168.1.102 is in range [100-115]                                                                           â”‚   â”‚
â”‚  â”‚    âœ“ 192.168.1.102 is not already allocated                                                                        â”‚   â”‚
â”‚  â”‚    â†’ Allocate 192.168.1.102 to the Service                                                                         â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. L2 ANNOUNCEMENT POLICY                                                                                          â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  CiliumL2AnnouncementPolicy: l2-policy                                                                              â”‚   â”‚
â”‚  â”‚    interfaces:                                                                                                      â”‚   â”‚
â”‚  â”‚      - ^eth[0-9]+   â—„â”€â”€â”€ Announce on ethernet interfaces                                                           â”‚   â”‚
â”‚  â”‚    nodeSelector:                                                                                                    â”‚   â”‚
â”‚  â”‚      matchLabels: {}  â—„â”€â”€â”€ All nodes can announce                                                                  â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  Cilium agent on ONE node becomes the "leader" for this IP                                                         â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. ARP ANNOUNCEMENT                                                                                                â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚   â”‚
â”‚  â”‚    â”‚   talos-worker-01        â”‚                            â”‚      Home Router         â”‚                             â”‚   â”‚
â”‚  â”‚    â”‚   192.168.1.113          â”‚  â•â•â•â•â•â• ARP Reply â•â•â•â•â•â•â–º  â”‚      192.168.1.1         â”‚                             â”‚   â”‚
â”‚  â”‚    â”‚   MAC: aa:bb:cc:11:22:33 â”‚                            â”‚                          â”‚                             â”‚   â”‚
â”‚  â”‚    â”‚                          â”‚  "192.168.1.102 is at      â”‚      ARP Table:          â”‚                             â”‚   â”‚
â”‚  â”‚    â”‚   (Cilium Leader)        â”‚   aa:bb:cc:11:22:33"       â”‚      192.168.1.102 â†’     â”‚                             â”‚   â”‚
â”‚  â”‚    â”‚                          â”‚                            â”‚        aa:bb:cc:11:22:33 â”‚                             â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  This is called "Gratuitous ARP" - announcing IPâ†’MAC mapping without being asked                                   â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚                                                              â”‚
â”‚                                                              â–¼                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. TRAFFIC ROUTING                                                                                                 â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚  â”‚    â”‚   Your PC    â”‚         â”‚  Home Router â”‚         â”‚   talos-worker-01        â”‚                                   â”‚   â”‚
â”‚  â”‚    â”‚              â”‚  â”€â”€â”€â”€â–º  â”‚              â”‚  â”€â”€â”€â”€â–º  â”‚   (Cilium Leader)        â”‚                                   â”‚   â”‚
â”‚  â”‚    â”‚   Browser:   â”‚   L2    â”‚  Looks up    â”‚   L2    â”‚                          â”‚                                   â”‚   â”‚
â”‚  â”‚    â”‚   Connect to â”‚ switch  â”‚  ARP table   â”‚ switch  â”‚   Receives packet to     â”‚                                   â”‚   â”‚
â”‚  â”‚    â”‚  192.168.1.102        â”‚  for .102    â”‚         â”‚   192.168.1.102:443      â”‚                                   â”‚   â”‚
â”‚  â”‚    â”‚              â”‚         â”‚              â”‚         â”‚                          â”‚                                   â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   Cilium processes via   â”‚                                   â”‚   â”‚
â”‚  â”‚                                                      â”‚   eBPF, routes to        â”‚                                   â”‚   â”‚
â”‚  â”‚                                                      â”‚   Gateway Pod            â”‚                                   â”‚   â”‚
â”‚  â”‚                                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>

            <div class="highlight-cyan">
                <h4>ğŸ¤” Why L2 Announcements?</h4>
                <p>Without a cloud provider's load balancer, you need a way to make LoadBalancer IPs reachable. Options:</p>
                <table>
                    <tr>
                        <th>Solution</th>
                        <th>How it works</th>
                        <th>Use case</th>
                    </tr>
                    <tr>
                        <td>MetalLB</td>
                        <td>Separate controller for L2/BGP</td>
                        <td>Traditional choice</td>
                    </tr>
                    <tr>
                        <td><strong>Cilium L2</strong></td>
                        <td>Built into CNI</td>
                        <td>Simpler, no extra components</td>
                    </tr>
                    <tr>
                        <td>BGP</td>
                        <td>Announces routes to router</td>
                        <td>Enterprise networks</td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- Complete Resource Map -->
        <section>
            <h2>ğŸ—ºï¸ Complete Resource Map</h2>
            <p>All Kubernetes resources involved in exposing ArgoCD with HTTPS.</p>

            <div class="architecture-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                                             â”‚
â”‚                                         KUBERNETES RESOURCES                                                                â”‚
â”‚                                                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  NAMESPACE: gateway                                                                                                 â”‚   â”‚
â”‚  â”‚                                                                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   â”‚
â”‚  â”‚  â”‚  GatewayClass             â”‚    â”‚  Gateway                  â”‚    â”‚  Gateway                  â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚  name: cilium             â”‚â—„â”€â”€â”€â”‚  name: gateway-internal   â”‚    â”‚  name: gateway-external   â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚    â”‚  IP: 192.168.1.101        â”‚    â”‚  IP: 192.168.1.102        â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚  controller: cilium.io/   â”‚    â”‚  listeners:               â”‚    â”‚  listeners:               â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚    gateway-controller     â”‚    â”‚    - http (:80)           â”‚    â”‚    - http (:80)           â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚    â”‚    - https (:443) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”¼â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â”‚
â”‚  â”‚                                                                                        â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚  â”‚  CiliumLoadBalancerIPPool â”‚    â”‚  CiliumL2AnnouncementPolicy                       â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚  â”‚  name: main-pool          â”‚    â”‚  name: l2-policy          â”‚                       â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚    â”‚                           â”‚                       â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚  â”‚  blocks:                  â”‚    â”‚  interfaces: ^eth[0-9]+   â”‚                       â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚  â”‚    192.168.1.100-115      â”‚    â”‚  nodeSelector: all        â”‚                       â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚                                                                                        â”‚ â”‚                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Secret: argocd-tls-secret                                                         â”‚ â”‚                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                                    â”‚ â”‚                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  type: kubernetes.io/tls                                                  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  data:                                                                               â”‚                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    tls.crt: <certificate>   â—„â”€â”€ Used by Gateway for TLS                             â”‚                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚    tls.key: <private key>   â—„â”€â”€ Used for decryption                                 â”‚                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                                                      â”‚                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  Created by: cert-manager                                                            â”‚                      â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                                         â”‚                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                            â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  NAMESPACE: cert-manager                                                                â”‚                          â”‚   â”‚
â”‚  â”‚                                                                                         â”‚                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚                          â”‚   â”‚
â”‚  â”‚  â”‚  ClusterIssuer            â”‚    â”‚  Certificate              â”‚                        â”‚                          â”‚   â”‚
â”‚  â”‚  â”‚  name: selfsigned-issuer  â”‚â—„â”€â”€â”€â”‚  name: argocd-tls-secret  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚    â”‚                           â”‚  (auto-created by cert-manager                    â”‚   â”‚
â”‚  â”‚  â”‚  spec:                    â”‚    â”‚  dnsNames:                â”‚   for Gateway)                                    â”‚   â”‚
â”‚  â”‚  â”‚    selfSigned: {}         â”‚    â”‚    - argocd.starbase...   â”‚                                                   â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚    â”‚  secretName: argocd-tls.. â”‚                                                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚   â”‚
â”‚  â”‚                                                                                                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                    â”‚   â”‚
â”‚  â”‚  â”‚  Deployment: cert-manager â”‚                                                                                    â”‚   â”‚
â”‚  â”‚  â”‚  Pods:                    â”‚                                                                                    â”‚   â”‚
â”‚  â”‚  â”‚    - cert-manager         â”‚  Watches Gateways, creates Certificates                                           â”‚   â”‚
â”‚  â”‚  â”‚    - cert-manager-webhook â”‚  Validates Certificate resources                                                  â”‚   â”‚
â”‚  â”‚  â”‚    - cert-manager-cainjector                                                                                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                                    â”‚   â”‚
â”‚  â”‚                                                                                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  NAMESPACE: argocd                                                                                                 â”‚   â”‚
â”‚  â”‚                                                                                                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚  â”‚  â”‚  HTTPRoute                â”‚    â”‚  Service                  â”‚    â”‚  Deployment               â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚  name: argocd-http        â”‚â”€â”€â”€â–ºâ”‚  name: argocd-server      â”‚â”€â”€â”€â–ºâ”‚  name: argocd-server      â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚    â”‚                           â”‚    â”‚                           â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚  parentRefs:              â”‚    â”‚  type: ClusterIP          â”‚    â”‚  containers:              â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚    - gateway-internal     â”‚    â”‚  ports:                   â”‚    â”‚    - argocd-server        â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚      sectionName: https   â”‚    â”‚    - port: 80             â”‚    â”‚      ports:               â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚    - gateway-external     â”‚    â”‚      targetPort: 8080     â”‚    â”‚        - 8080 (HTTP)      â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚      sectionName: https   â”‚    â”‚    - port: 443            â”‚    â”‚        - 8443 (HTTPS)     â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚  hostnames:               â”‚    â”‚      targetPort: 8443     â”‚    â”‚                           â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚    - argocd.starbase..    â”‚    â”‚                           â”‚    â”‚                           â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚  backendRefs:             â”‚    â”‚                           â”‚    â”‚                           â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚    - argocd-server:80 â”€â”€â”€â”€â”‚â”€â”€â”€â–ºâ”‚                           â”‚    â”‚                           â”‚                  â”‚   â”‚
â”‚  â”‚  â”‚                           â”‚    â”‚                           â”‚    â”‚                           â”‚                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚   â”‚
â”‚  â”‚                                                                                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>
        </section>

        <!-- Quick Reference -->
        <section>
            <h2>ğŸ“‹ Quick Reference Card</h2>
            
            <div class="component-grid">
                <div class="component-card">
                    <h4 style="color: var(--accent-cyan);">ğŸ”‘ Key IPs</h4>
                    <pre><code>Gateway Internal: 192.168.1.101
Gateway External: 192.168.1.102
Control Plane:    192.168.1.112
Worker 1:         192.168.1.113
Worker 2:         192.168.1.114</code></pre>
                </div>
                <div class="component-card">
                    <h4 style="color: var(--accent-cyan);">ğŸ”’ TLS Secret</h4>
                    <pre><code>Name: argocd-tls-secret
Namespace: gateway
Issuer: selfsigned-issuer
DNS: argocd.starbasestudio.uk</code></pre>
                </div>
                <div class="component-card">
                    <h4 style="color: var(--accent-cyan);">ğŸš¦ Traffic Path</h4>
                    <pre><code>Browser
  â†“ HTTPS (encrypted)
Gateway :443
  â†“ HTTP (plain)
Service :80
  â†“ HTTP (plain)
Pod :8080</code></pre>
                </div>
                <div class="component-card">
                    <h4 style="color: var(--accent-cyan);">ğŸ”§ Debug Commands</h4>
                    <pre><code># Check Gateway
kubectl get gateway -n gateway

# Check Certificate
kubectl get certificate -A

# Check HTTPRoute
kubectl describe httproute -n argocd

# Test connectivity
curl -vk https://argocd.starbasestudio.uk</code></pre>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <p>ğŸ  Homelab Architecture Documentation | Gateway API + Cilium + cert-manager + ArgoCD</p>
        <p>Generated: January 2026</p>
    </footer>
</body>
</html>
